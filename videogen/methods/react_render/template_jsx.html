<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>{{TITLE}}</title>
<script src="{{REACT_UMD}}"></script>
<script src="{{REACTDOM_UMD}}"></script>
<script src="{{BABEL_UMD}}"></script>
<style>
  :root {
    --w: {{WIDTH}}px;
    --h: {{HEIGHT}}px;
    --bg: #0b0f1a;
    --fg: #e7eaf3;
    --muted:#9aa4bc;
  }
  html,body { margin:0; height:100%; background:#000; }
  .stage { display:grid; place-items:center; height:100%; }
  .frame {
    position:relative; width:var(--w); height:var(--h);
    background: #0f1629;
    border:1px solid rgba(255,255,255,.06);
    border-radius:16px; overflow:hidden;
    box-shadow: 0 16px 40px rgba(0,0,0,.45);
  }
  #stage { position:absolute; inset:0; }
  .subtitle {
    position:absolute; left:0; right:0; bottom:22px;
    text-align:center; color:var(--muted); font-size:22px; letter-spacing:.2px;
    text-shadow: 0 2px 8px rgba(0,0,0,.55);
    padding: 0 24px;
  }
</style>
</head>
<body>
  <div class="stage">
    <div class="frame">
      <div id="stage"></div>
<!--      <div class="subtitle">{{SUBTITLE}}</div>-->
    </div>
  </div>

  {{SCENE_BABEL}}

  <script>
    // 标准播放器（单场景）：优先等待 window.__PLAY_DONE，否则按 DURATION 结束
    (function(){
      const root = ReactDOM.createRoot(document.getElementById('stage'));

      function mount() {
        const Comp = window.__SCENE__ || (function Placeholder(){
          return React.createElement('div', {
            style:{display:'grid',placeItems:'center',width:'100%',height:'100%',color:'#e7eaf3',fontSize:42}
          }, 'No Scene');
        });
        root.render(React.createElement(Comp));
      }

      function endAfter(ms){
        const t = Math.max(500, Number(ms)||0);
        setTimeout(() => { if (window.__PLAY_DONE !== true) window.__PLAY_DONE = true; }, t);
      }

      window.addEventListener('DOMContentLoaded', function(){
        // 若 JSX 内部会在动画结束时设置 window.__PLAY_DONE，这里只兜底时长
        mount();
        endAfter({{DURATION_MS}});
      });
    })();
  </script>
</body>
</html>
